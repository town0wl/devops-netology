### ДЗ 3.7

1.
Если отправитель не получает ответа за время, пока он отсылает данные в размере окна, он приостанавливает отправку. Для достижения время отправки данных в размере окна должно быть равно или больше RTT. Т.е.:\
(размер окна)/(1 Гбит/с) >= 300мс\
размер окна >= 38.4 МБ\
В оригинальном TCP Window Size – 16 битное число, которое обозначает размер окна в байтах, - максимум 65535 байт. Есть дополнительная опция Window scale, которая позволяет увеличить размер окна до 1 Гбайта. Чтобы задействовать эту опцию, обе стороны должны согласовать это в своих SYN сегментах.

2.
Если присутствует 1% потерь пакетов, то этот 1% пакетов потребуется переслать повторно. А далее 1% от этих пакетов и так далее, но пренебрежем этим, т.к. этот вклад на 2 и более порядков меньше. Итого передача заданного количества пакетов займет в 1,01 больше времени, т.е. скорость упадет в 1,01 раза.

3.
Каждый пакет, содержащий MSS полезных данных, будет реально требовать передачи (MSS + 20 байт (или больше) заголовка TCP + 20 байт (или больше) заголовка IP + 36 байт (или больше) служебных Ethernet). Если рассматривать MSS 1460 байт, то полезные данные будут составлять 95% передаваемых данных или менее, т.е. максимальная скорость передачи данных будет около 95 Мбит/с. Если увеличить размер фрейма, можно достичь более близкой к 100 Мбит/с скорости, если уменьшить размер фрейма - можно существенно снизить скорость.

4.
curl -I http://netology.ru \
Так как netology.ru нет в кеше DNS, также в hosts, надо определить IP - отправить запрос к установленному DNS. Допустим, DNS находится в локальном сегменте. Нужно получить MAC DNS:\
хост берет адрес DNS-сервера из конфигурации\
хост определяет по таблице роутинга на какой интефейс обращаться к DNS-серверу\
хост по маске сети определяет, что DNS находится в локальном сегменте\
хост отправляет широковещательный ARP-запрос с IP DNS\
хост получает ответ с MAC-адресом DNS\
хост открывает UDP сокет и отправляет DNS-запрос в UDP (53) на IP DNS на MAC DNS\
хост получает ответ на открытый UDP сокет и закрывает его\
хост определяет по таблице роутинга на какой интефейс обращаться к netology.ru и видит, что он за маршрутизатором\
хост отправляет широковещательный ARP-запрос с IP маршрутизатора\
приходит ответ с MAC-адресом маршрутизатора\
хост открывает TCP сокет и инициирует TCP-соединение с netology.ru, отправив SYN в TCP (80) на IP netology.ru на MAC маршрутизатора\
после установки сессии TCP хост отправляет в сокет HTTP-запрос\
хост получает HTTP-ответ и закрывает сокет

5.
3 запроса: к корневому серверу, к TLD и к серверу зоны запрашиваемого имени, например:\
dig www.google.co.uk. @a.root-servers.net.\
dig www.google.co.uk. @dns1.nic.uk.\
dig www.google.co.uk. @ns1.google.com.

6.
в /25 - 126 адресов для хостов\
в 255.248.0.0 - 524 286

7.
В подсети с маской /23 больше адресов, чем с /24

8.
Минимальная подсеть, куда вмещаются 131070 адресов, - /15. В диапазоне 10.0.0.0/8 можно выделить как раз максимум 128 таких подсетей. Т.е. разделить получится.






### ДЗ 3.6

2.
Всего 14 каналов на частоте 2.4 ГГц, но 14й используется только в Японии. В Северной Америке ограничено использование каналов 12 и 13. В любом случае можно выделить 3 непересекающихся канала, например, 1, 6 и 11.

3.
38:f9:d3\
Apple, Inc.

4.
До 8949 байт включительно.

5.
Нет, т.к. SYN сигнализирует об открытии соединения, FIN - о закрытии соединения, а случая совместного использования этих флагов не предусмотрено.

6.
В выводе информация о сокете UDP, т.к. указан флаг -u. В UDP нет сессии, поэтому нет состояний сессий: TIME-WAIT, CONN и прочих. 

7.
ESTAB - ESTAB\
  FIN ->\
Инициатор закрытия отправляет FIN и переходит в состояние FIN-WAIT-1. Ответчик после получения FIN переходит в состояние CLOSE-WAIT.\
FIN-WAIT-1 - CLOSE-WAIT\
   <- ACK\
Ответчик отправляет ACK в ответ на FIN инициатора. При получении этого ACK инициатор переходит в FIN-WAIT-2. Ответчик досылает оставшиеся данные.\
FIN-WAIT-2 - CLOSE-WAIT\
   <- FIN\
Завершив передачу, ответчик отправляет FIN и переходит в состояние LAST-ACK. Инцииатор, получив FIN, отправляет ACK ответчику и переходит в состояние TIME-WAIT.\
TIME-WAIT - LAST-ACK\
  -> ACK\
Ответчик, получив ACK в ответ на FIN, закрывает соединение. Инициатор закрывает соединение спустя таймаут с отправки последнего ACK.\
TIME-WAIT - CLOSED\
  \<timeout>\
CLOSED - CLOSED

8.
Если рассматривать протокол TCP. Теоретическое максимальное число соединений, ограниченное только лишь параметрами L4, которое параллельно может установить клиент с одного IP адреса к серверу с одним IP адресом, - 65535. Такое же теоретическое максимальное количество соединений от одного клиента (IP), которое может одновременно обслуживать сервер; но ограничено имеено тем, что клиент не может открыть больше. Сервер использует общие сокеты TCP для разных клиентов, поэтому общее количество соединений не ограничено параметрами L4, а ограничено архитектурой и ресурсами серверного приложения.

9.
TIME-WAIT возникает только у инициатора завершения соединения, обычно это клиент, после получения FIN с другой стороны. Если возникло много TIME-WAIT, значит, хост инициировал закрытие большого количества соединений, закрытия прошли успешно и еще не прошел таймаут TIME_WAIT. Сеть работает корректно, но порты, занятые соединениями TIME-WAIT, не доступны, пока соединение не закроется, что может стать проблемой нехватки свободных портов TCP. Можно уменьшить таймаут /proc/sys/net/ipv4/tcp_fin_timeout или увеличить диапазон разрешенных клиентских портов /proc/sys/net/ipv4/ip_local_port_range. 

10.
В UDP отсуствует нумерация сегментов. Получатель не знает о потерянных сегментах и не может проконтролировать целостность полученных данных и определить потерянные участки (без дополнительной работы со стороны вышестоящего протокола).

11.
RELP (TCP), потому что обеспечивает доставку без потерь.

12.
```
# ss -anltp
State            Recv-Q           Send-Q                     Local Address:Port                       Peer Address:Port           Process
LISTEN           0                4096                             0.0.0.0:111                             0.0.0.0:*               users:(("rpcbind",pid=552,fd=4),("systemd",pid=1,fd=35))
LISTEN           0                4096                       127.0.0.53%lo:53                              0.0.0.0:*               users:(("systemd-resolve",pid=553,fd=13))
LISTEN           0                128                              0.0.0.0:22                              0.0.0.0:*               users:(("sshd",pid=2050,fd=3))
LISTEN           0                4096                                [::]:111                                [::]:*               users:(("rpcbind",pid=552,fd=6),("systemd",pid=1,fd=37))
LISTEN           0                128                                 [::]:22                                 [::]:*               users:(("sshd",pid=2050,fd=4))
```

13.
В текстовом виде - -A.\
В тектовом и hex - -X или -XX (с включением заголовков канального уровня).

14.
Встретился флаг: 0x40, Don't fragment\
Всего 3 флага у IP4: 1й не используется, 2й - не фрагментировать, 3й - у пакета есть еще фрагменты.\
Ethernet II (DIX Ethernet)\
Wireshark сам подставляет значение OUI по MAC адресу, например: PcsCompu_e3:90:c5 (08:00:27:e3:90:c5)
