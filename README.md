### ДЗ 11.3

1.  
**GitLab**, опционально Hashicorp Vault

GitLab:
Включает систему контроля версий Git и CI/CD с богатой функциональностью, а также вспомогательные сервисы Packages & Registries, Wiki, создание и обработке issues. Идеален для начала работы с микросервисами, т.к. содержит все необходимое, но также хорошо подходит для крупных и развитых сред, т.к. предоставляет широкие функциональные возможности, в частности по CI.  
\+ Облачная система; - SaaS от производителя или самостоятельно развернуть в любом облаке по выбору.  
\+ Система контроля версий Git;  
\+ Репозиторий на каждый сервис;  
\+ Запуск сборки по событию из системы контроля версий;  
\+ Запуск сборки по кнопке с указанием параметров;  
\+ Возможность привязать настройки к каждой сборке;  
\+ Возможность создания шаблонов для различных конфигураций сборок;  
\+ Возможность безопасного хранения секретных данных: пароли, ключи доступа; - С помощью скрытых переменных, Hashicorp Vault, переменных K8S_SECRET_*.  
\+ Несколько конфигураций для сборки из одного репозитория; - Можно использовать вложенные файлы конфигурации сборки с разными пайплайнами и триггеры для их запуска.  
\+ Кастомные шаги при сборке; - Пайплайн описывается свободно с произвольными стадиями и скриптами.  
\+ Собственные докер образы для сборки проектов; - Есть встроенная подсистема registries для хранения докер-образов.  
\+ Возможность развернуть агентов сборки на собственных серверах; - GitLab Runner: GNU/Linux (CentOS, Debian, Ubuntu, RHEL, Fedora, Mint), macOS, FreeBSD, Windows / x86, AMD64, ARM64, ARM, s390x, ppc64le  
\+ Возможность параллельного запуска нескольких сборок; Возможность параллельного запуска тестов; - Можно запускать задачи параллельно с помощью комбинации в один stage, подзадачи - с помощью опции 'parallel'  

2.  
**Fluent Bit** в качестве агента на нодах, отправляющего логи в Fluentd  
централизованный **Fluentd** - сбор, фильтрация, обработка и промежуточный буфер  
**ElasticSearch** - хранение и поиск  
**Kibana** - интерфейс доступа и визуализация  

Fluentd:  
Ruby  
лицензия Apache 2  
~ 10000 событий/сек  
сортировка собыйти по тегам  
встроенный драйвер в docker для отправки логов в Fluentd  

Fluent Bit:  
облегченный агент на C для нод от авторов Fluentd  
читает логи из файлов docker (как и Fluentd), приложения в docker могут писать логи в STDOUT (в виде json)

ElasticSearch/Kibana:  
наиболее распространенный вариант для хранения и просмотра логов с максимальным сообществом и количеством информации  
ElasticSearch обеспечивает эффективный поиск и фильтрацию по логам  
Kibana позволяет сохранять результаты поиска (Once you’ve created a search worth saving in Discover, click Save in the toolbar.)

3.
**Prometheus** для сбора и хранения метрик  
**Pushgateway** для сбора метрик в случаях использования Push-модели  
**Fluent Bit** для предоставления метрик с хостов (prometheus exporter плагин)  
предоставление метрик сервисов средствами приложения или **Prometheus exporters** (в виде дополнительного сервиса в том же поде)  
**Kube-state-metrics** для предоставления метрик уровня кластера k8s  
**Grafana** для визуализации и построения панелей наблюдения  
**Alertmanager** для автоматического оповещения по результатам отслеживания метрик  
При необходимости длительного хранения метрик (например, для статистических целей) ClickHouse или Victoria Metrics, т.к. Prometheus не предназначен для этого (подходит для хранения до 15 дней).

Prometheus работает по Pull-модели - сам забирает метрики из указанных источников. Можно подключить любые источники, предоставляющие метрики в подходящем формате, в том числе на уровне приложения.  
Prometheus хорошо интегрирован с Kubernetes: может обращаться к API Server и взаимодействовать с ним.  
Prometheus поддерживает несколько способов автообнаружения сервисов.  
Prometheus популярен, поэтому его поддерживает большое количество приложений и языков программирования.


### ДЗ 11.1

#### Выгоды:
- Ускорить разработку, выпуск исправление, доработок, новой функциональности
- Упростить управление разработкой, что позволит увеличить эффективность при большом количестве разработчиков.
- Возможность независимого создания новых сервисов и фич для клиентов.
- Увеличить отказоустойчивость компонентов системы и работы магазина в целом.
- Возможность балансировки нагрузки и вариации количества используемых ресурсов. Динамическое распределение ресурсов позволит обрабатывать поток заказов в пиковые периоды с меньшим необходимым количеством оборудования.  
#### Проблемы (задачи):
- Разбить штат разработчиков на команды, а софт на отдельные домены, определить ответственных.
- Сформулировать принципы для сервисов и взаимодействия между ними, задающие высокоуровневые требования к их реализации. Определить схему взаимодействия между сервисами и требования к их API, а также требования к документации.
- Иметь компетенции для автоматизации процессов разработки, развертывания, эксплуатации, управления ресурсами.

