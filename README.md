### ДЗ 5.3
1.
Высоконагруженное монолитное java веб-приложение - на хост для улучшения производительности. Но можно и в контейнере с достаточными выделенными ресурсами. Но т.к. приложение монолитное при любых изменения придется пересобирать образ контейнера.\
Go-микросервис для генерации отчетов - хорошо подойдет докер, так как легко воспроизвести необходимое окружение.\
Nodejs веб-приложение - хорошо подойдет докер, так как легко воспроизвести необходимое окружение.\
Мобильное приложение c версиями для Android и iOS - хорошо подойдет докер, так как легко воспроизвести необходимое окружение.\
База данных postgresql используемая, как кэш - одиночная база данных, хранящая временные данные, может работать в контейнере. Плюсы контейнера - возможность быстро очистить состояние, быстро включить/выключить/развернуть/удалить/перенести на другой хост, так что это хороший вариант.\
Шина данных на базе Apache Kafka - на хостах для улучшения производительности. Или в контейнерах - для хорошей масштабируемости, нужную производительность при этом достичь за счет достаточного числа инстансов и балансировки; данные при этом на "железном" внешнем быстром хранилище.\
Очередь для Logstash на базе Redis - Redis хранит все данные в памяти, что чревато потерей логов при падении СУБД или исчерпании памяти. Но если очень надо - то контейнер с достаточным количеством памяти, т.к. выделять хост или виртуальную машину под вспомогательную задачу - слишком громоздкое решение (вызывает необходимость этот хост или виртуалку чинить в случае чего).\
Elastic stack для реализации логирования продуктивного веб-приложения - три ноды elasticsearch, два logstash и две ноды kibana - данные, сохраняемые elasticsearch, должны быть на внешнем "железном" быстром хранилище, сами приложения elasticsearch, logstash и kibana вполне могут быть в контейнерах, что даст хорошую масштабируемость и управляемость. Для увеличения производительности можно разместить Elasticsearch на реальных хостах.\
Мониторинг-стек на базе prometheus и grafana - prometheus можно на хосте/виртуалке или в контейнере с внешним хранением данных и решением вопросов сетевой конфигурации (подключении клиентов, сбрасывающих метрики, в условиях динамичности контейнеров). Grafana, как интерфейс визуализации, отлично будет работать в контейнере.\
Mongodb, как основное хранилище данных для java-приложения - у продуктивной СУБД будет резервирование с внутренней репликацией данных, нужны статические хранилища данных, что плохо сочетается со средой контейнеризации. Подойдут физические хосты, как предоставляющие максимальную производительность, или виртуальные машины.\
Jenkins-сервер - В целом, может работать в любом варианте, но отдельный хост заведомо проигрывает виртуальной машине благодаря возможности бэкапа, переноса, копирования последней. Jenkins будет запускать новые контейнеры/поды в своей среде, что надо учитывать при его размещении, в частности для достаточности ресурсов при установке на виртуалку. При работе в контейнере плюсом будет изоляция Jenkins от других контейнеров/подов.


2.
https://hub.docker.com/repository/docker/town0wl/netology-repo

3.
```
# docker run -v "$(pwd)"/info:/share/info --name centos_i -dt centos:7
# docker run -v "$(pwd)"/info:/info --name debian_i -dt debian
# docker exec -it centos_i bash
# echo "The CentOS file" >> /share/info/file_1
# exit
# echo "The Host File" > info/fileH
# docker exec -it debian_i bash
# more /info/*
::::::::::::::
/info/fileH
::::::::::::::
The Host File
::::::::::::::
/info/file_1
::::::::::::::
The CentOS file
# exit
# docker ps -a
CONTAINER ID   IMAGE      COMMAND       CREATED         STATUS         PORTS     NAMES
2697ad20460d   debian     "bash"        3 minutes ago   Up 3 minutes             debian_i
8ca27679ba07   centos:7   "/bin/bash"   3 minutes ago   Up 3 minutes             centos_i
```

### ДЗ 5.2
1.
100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований - KVM или Xen. Потому что нет смысла переплачивать за VMware, если нет особых требований, а Hyper-V может не поддерживать все нужные Linux.\
Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий - Hyper-V, т.к. Windows-ориентированное рещение с богатым функционалом и высоким быстродействием.\
Требуется наиболее производительное бесплатное opensource решение для виртуализации небольшой (20 серверов) инфраструктуры Linux и Windows виртуальных машин - KVM, т.к. это наиболее производительное бесплатное opensource с хорошей поддержкой Linux и Windows.\
Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры - Windows Hyper-V Server - бесплатная серверная версия гипервизора от Microsoft.\
Необходимо рабочее окружение для тестирование программного продукта на нескольких дистрибутивах Linux - KVM (или VirtualBox при небольших масштабах), т.к. бесплатно, просто в использовании, хорошо работает с Linux.

2.
Cценарий миграции с VMware vSphere на Hyper-V для Linux и Windows виртуальных машин:
1) Выключить ВМ
2) Конвертировать диск ВМ в VHD/VHDX, можно использовать vhdtool.exe, vhdxtool.exe, System Center Virtual Machine Manager, Microsoft Virtual Machine Converter, StarWind V2V Image Converter, Disk2VHD или другого.
3) Создать ВМ с полученным диском и нужной конфигурацией в Hyper-V
4) Включить службы интеграции Hyper V\
В ВМ Windows через управление службами внутри ВМ или из гипервизора через PowerShell:\
Get-VMIntegrationService -VMName "DemoVM"\
Enable-VMIntegrationService -VMName "DemoVM" -Name "Guest Service Interface"\
В Linux установить Linux Integration Services. Для ОС, где драйвера LIS уже установлены (нпр. Ubuntu с версии 12.04 и выше), активировать модули ядра hv_vmbus, hv_storvsc, hv_blkvsc, hv_netvsc в /etc/initramfs-tools/modules, затем:\
update-initramfs –u\
shutdown -r now\
Для Linux, где не установлены драйвера LIS, - скачать iso "Linux Integration Services for Hyper-V", подключить к гостю, выполнить скрипт Install.SH.
5) Удалить VMware Tools
6) Удалить неиспользуемые старые устройства

3.
Недостатки гетерогенной среды виртуализации в необходимости управления различными используемыми системами виртуализации и наличия компетенций для работы с каждой из них (конфигурация, в том числе связанные сети и системы хранения данных, оптимизации, учет ограничений по оборудованию и возможностям виртуализации, диагностика, разбор проблем). Количество сложностей варьируется в зависимости от глубины погружения: про базовом, "пользовательском" уровне использования различных систем виртуализации проблем не будет. При необходимости жесткой оптимизации ресурсов, высоких требованиях к доступности и производительности, больших объемах среды количество проблем будет возрастать. При этом внедрение дополнительных систем виртуализации может помочь сэкономить или оптимизировать критичные процессы/добиться максимальной производительности. Так что в целом это допустимо и полезно, однако надо оценить затраты на поддержку дополнительной системы виртуализации. Минимизировать их можно путем ограничения сложности создаваемой дополнительной среды виртуализации (например, по количеству и разнообразию ВМ, количеству требований к производительности, оптимизации, процессам управления), а также использовать уже настроенные процессы управления и элементы инфраструктуры, если они поддерживаются.

### ДЗ 5.1
1. 
Паравиртуализация и виртуализация на основе ОС - совсем разные подходы. В первом случае для реализации виртуализации используется гипервизор, как и в случае полной виртуализации, но гостевые операционные системы модифицированы для оптимальной работы с гипервизором и прямого использования предоставляемого им API. Виртуализация на основе ОС реализуется полностью средствами ОС по выделению и изоляции ресурсов.

2. 
Высоконагруженная база данных, чувствительная к отказу, - физические сервера. Для уменьшения времени работы с оборудованием - диском и сетью.\
Различные Java-приложения - виртуализация уровня ОС. Для масштабируемости и экономии ресурсов.\
Windows системы для использования Бухгалтерским отделом - физические машины, полная виртуализация или паравиртуализация. Для удобства использования, бэкапов и восстановления, разграничения доступа.\
Системы, выполняющие высокопроизводительные расчеты на GPU, - физические сервера или виртуализация уровня ОС. Для уменьшения времени работы с оборудованием - GPU.

3. 
Да, например, VMware Workstation с виртуальной машиной Windows, внутри которой гипервизор (например, VMware Player) с виртуальной машиной Linux. А на базовом хосте еще docker и VirtualBox, а можно и не на базовом, а на виртуалке.
